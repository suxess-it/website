<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Reduce risks, time and costs with kubriX | kubriX</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https:/kubrix.io/blog/benefits-idp-distribution-quality-gates"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Reduce risks, time and costs with kubriX | kubriX"><meta data-rh="true" name="description" content="An IDP often consists of several products or opensource projects. Updating those components is one thing your platform team needs to do regularly for several reasons:"><meta data-rh="true" property="og:description" content="An IDP often consists of several products or opensource projects. Updating those components is one thing your platform team needs to do regularly for several reasons:"><meta data-rh="true" name="keywords" content="kubriX,benefits,quality checks"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-10-18T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/jkleinlercher"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https:/kubrix.io/blog/benefits-idp-distribution-quality-gates"><link data-rh="true" rel="alternate" href="https:/kubrix.io/blog/benefits-idp-distribution-quality-gates" hreflang="en"><link data-rh="true" rel="alternate" href="https:/kubrix.io/blog/benefits-idp-distribution-quality-gates" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https:/kubrix.io/blog/benefits-idp-distribution-quality-gates","mainEntityOfPage":"https:/kubrix.io/blog/benefits-idp-distribution-quality-gates","url":"https:/kubrix.io/blog/benefits-idp-distribution-quality-gates","headline":"Reduce risks, time and costs with kubriX","name":"Reduce risks, time and costs with kubriX","description":"An IDP often consists of several products or opensource projects. Updating those components is one thing your platform team needs to do regularly for several reasons:","datePublished":"2024-10-18T00:00:00.000Z","author":{"@type":"Person","name":"Johannes Kleinlercher","description":"kubriX Dev, platform engineer, systems architect","url":"https://github.com/jkleinlercher","image":"https://avatars.githubusercontent.com/u/11465610?v=4"},"keywords":["kubriX","benefits","quality checks"],"isPartOf":{"@type":"Blog","@id":"https:/kubrix.io/blog","name":"Blog"}}</script><script data-rh="true">localStorage.getItem("theme")&&(localStorage.removeItem("theme"),window.location.reload())</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="kubriX RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="kubriX Atom Feed"><link rel="stylesheet" href="/assets/css/styles.3d2e299c.css">
<script src="/assets/js/runtime~main.5f7240fc.js" defer="defer"></script>
<script src="/assets/js/main.c00f0731.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#20232a;color:#fff" role="banner"><div class="content_knG7 announcementBarContent_xLdY">⭐️ If you like kubriX, give it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/suxess-it/kubriX">GitHub</a>! ⭐️</div></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"></a><a class="navbar__item navbar__link" href="/">Home</a><a class="navbar__item navbar__link" href="/docs/welcome">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/plans">Plans</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/benefits-idp-distribution-quality-gates">Reduce risks, time and costs with kubriX</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/team-topologies-platform-engineering">Treat your platform as a product</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/kubrix-platform-release">kubriX platform - released</a></li></ul></div></nav></aside><main class="col col--7"><article><header><h1 class="title_f1Hy">Reduce risks, time and costs with kubriX</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-10-18T00:00:00.000Z">October 18, 2024</time> · <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/jkleinlercher" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://avatars.githubusercontent.com/u/11465610?v=4" alt="Johannes Kleinlercher"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/jkleinlercher" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Johannes Kleinlercher</span></a></div><small class="authorTitle_nd0D" title="kubriX Dev, platform engineer, systems architect">kubriX Dev, platform engineer, systems architect</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>An IDP often consists of several products or opensource projects. Updating those components is one thing your platform team needs to do regularly for several reasons:</p>
<ul>
<li>get the newest features</li>
<li>get bug fixes to increase stability</li>
<li>get security fixes to fulfill your vulnerability mgmt</li>
</ul>
<p>Those updates can be time-consuming and error-prone. However, kubriX keeps your platform up-to-date
and our quality checks dramatically reduce your efforts and deployment risks.</p>
<p>As the following real life example shows, sometimes updates can be really hard.</p>
<p>Recently a new version from <a href="https://github.com/grafana/helm-charts/releases/tag/mimir-distributed-5.5.0" target="_blank" rel="noopener noreferrer">Grafana Mimir Helm-Chart 5.5.0</a> was released.
I don&#x27;t know wether you are a person who really evaluates changelogs before updates,
but also if you did read the <a href="https://github.com/grafana/mimir/blob/main/operations/helm/charts/mimir-distributed/CHANGELOG.md#550" target="_blank" rel="noopener noreferrer">Changelog for 5.5.0</a>, you won&#x27;t recognize any breaking changes.</p>
<p>However, the first time you would probably recognize a problem is that your Grafana Mimir ArgoCD application stays OutOfSync forever. If you take a closer look to the diff, you will see:</p>
<p><img decoding="async" loading="lazy" src="https://github.com/user-attachments/assets/3c0bb034-8827-4c25-81b5-8b67c99b4eed" alt="image" class="img_ev3q"></p>
<p>green (right side) is desired state, left is current state.</p>
<p>You then probably ask yourself and your team mates why the hack this app doesn&#x27;t sync anymore. Are there some conflicts with another app overriding this configuration? Is the Grafana Agent Operator overriding the GrafanaAgent instance? Is your GrafanaAgent CRD not compatible with this new GrafanaAgent after update? Where is this CRD defined? Do I need to have a look at new sync options ArgoCD provides (and they provide a lot of them)?</p>
<p>Believe me, this problem will take you hours even though you are very experiences, unless you have the right guess in the first place.</p>
<p>The problem was, that the <a href="https://github.com/grafana/agent/blob/69e7872651069b20cf9b8b67d9d210c1db245885/operations/agent-static-operator/crds/monitoring.grafana.com_grafanaagents.yaml" target="_blank" rel="noopener noreferrer">GrafanaAgent CRD</a> supports the attribute <code>topologySpreadConstraints</code>, but the indentation in the GrafanaAgent CR was wrong in Mimir 5.5.0. So it was not compliant to the GrafanaAgent CRD spec.</p>
<p>However, why did ArgoCD just show a OutOfSync problem? This is actually an <a href="https://github.com/argoproj/argo-cd/issues/16817" target="_blank" rel="noopener noreferrer">open issue in ArgoCD</a>.</p>
<p>When you apply the manifests manually, you would see</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Error from server (BadRequest): error when creating &quot;STDIN&quot;: GrafanaAgent in version &quot;v1alpha1&quot; cannot be handled as a GrafanaAgent: strict decoding error: unknown field &quot;spec.containers[1].topologySpreadConstraints&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">and indeed topologySpreadConstraints is not a valid attribute inside containers attribute.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>The benefits of kubriX</h1>
<p>We do those update tests for you already and will check already lots of things what otherwise your platform team needs to do. Only when our quality gates show a green light we integrate those new versions in our kubriX platform.</p>
<p>When we recognize problems like this above, we will <a href="https://github.com/grafana/mimir/issues/9638" target="_blank" rel="noopener noreferrer">open an issue</a> on the original upstream project and help to <a href="https://github.com/grafana/mimir/pull/9670" target="_blank" rel="noopener noreferrer">solve this problem</a> together with the maintainers.</p>
<p>Only for this problem above you will save at least 3-4 days updates, troubleshooting, communication with the community, and fixing the updates.</p>
<p>You can see our real life tests and investigations in this <a href="https://github.com/suxess-it/kubriX/pull/722#issuecomment-2412002619" target="_blank" rel="noopener noreferrer">renovate PR</a></p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><a href="https://github.com/suxess-it/website/tree/main/blog/2024-10-18-benefits-quality-gates/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/blog/team-topologies-platform-engineering"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Treat your platform as a product</div></a></nav></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/welcome">Get Started</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/suxess-it/kubriX" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://join.slack.com/t/kubrix-platform/shared_invite/zt-2rc1yty2f-VTT3GOzUvo_k5hrgKbppKQ" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li><li class="footer__item"><a href="https://github.com/suxess-it/kubriX/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Issues</a></li><li class="footer__item"><a href="https://github.com/orgs/suxess-it/projects/1/views/3" target="_blank" rel="noopener noreferrer" class="footer__link-item">Roadmap</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/plans#contact">Contact</a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="hhttps://suxess-it.com/impressum/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms Of Service<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://suxess-it.com/datenschutz" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 - kubriX, powered by <a target="_blank" rel="noopener noreferrer" href="https://suxess-it.com">suXess information technologies gmbh</a></div></div></div></footer></div>
</body>
</html>