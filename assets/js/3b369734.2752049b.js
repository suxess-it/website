"use strict";(self.webpackChunkkubrix=self.webpackChunkkubrix||[]).push([[682],{1620:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>c});var n=s(4848),i=s(8453);s(6540),s(2303);const a={slug:"/"},r="Getting Started",l={id:"getting-started",title:"Getting Started",description:"You can start a test environment with GitHub Codespaces.",source:"@site/docs/01-getting-started.mdx",sourceDirName:".",slug:"/",permalink:"/website/docs/",draft:!1,unlisted:!1,editUrl:"https://github.com/suxess-it/website/tree/main/docs/01-getting-started.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{slug:"/"},sidebar:"defaultSidebar"},o={},c=[{value:"accessing platform service consoles",id:"accessing-platform-service-consoles",level:2},{value:"known issues",id:"known-issues",level:2},{value:"how to set it up",id:"how-to-set-it-up",level:2},{value:"prereqs",id:"prereqs",level:3},{value:"mkcert",id:"mkcert",level:4},{value:"create GitHub OAuth App",id:"create-github-oauth-app",level:4},{value:"1. define some variables so the platform can access github",id:"1-define-some-variables-so-the-platform-can-access-github",level:3},{value:"2. create k3d cluster",id:"2-create-k3d-cluster",level:3},{value:"3. log in to the tools",id:"3-log-in-to-the-tools",level:3},{value:"4. kubecost",id:"4-kubecost",level:3},{value:"5. keycloak",id:"5-keycloak",level:3},{value:"6. Onboard teams and applications",id:"6-onboard-teams-and-applications",level:3},{value:"7. Promote apps with Kargo",id:"7-promote-apps-with-kargo",level:3},{value:"delete k3d cluster",id:"delete-k3d-cluster",level:3},{value:"Build suXess backstage container image and push it to our registry",id:"build-suxess-backstage-container-image-and-push-it-to-our-registry",level:3},{value:"automatically with Github Actions",id:"automatically-with-github-actions",level:4},{value:"manually on local machine",id:"manually-on-local-machine",level:4}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"getting-started",children:"Getting Started"})}),"\n",(0,n.jsx)(t.h1,{id:"test-kubrix-with-github-codespaces",children:"Test kubrix with GitHub Codespaces"}),"\n",(0,n.jsx)(t.p,{children:"You can start a test environment with GitHub Codespaces."}),"\n",(0,n.jsx)(t.p,{children:"A k3d cluster and our platform stack gets installed during startup of the codespace,\nso just try it with the button below!"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.a,{href:"https://codespaces.new/suxess-it/sx-cnp-oss",children:(0,n.jsx)(t.img,{src:"https://github.com/codespaces/badge.svg",alt:"Open in GitHub Codespaces"})})}),"\n",(0,n.jsxs)(t.p,{children:["Don't forget to choose a kubrix scenario and choose 4 cores:\n",(0,n.jsx)(t.img,{src:"https://github.com/user-attachments/assets/767d389e-fa03-4e5d-9df1-d270050afa0c",alt:"image"})]}),"\n",(0,n.jsx)(t.p,{children:'You will get a VSCode environment in your browser and then inside this devcontainer\na K3d cluster will get created and the platform stack will get installed.\nThis will take up to 20 minutes. You can follow the installation in the terminal and log\nby clicking on the link "Building codespace...":'}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:"https://github.com/user-attachments/assets/0c1d88cb-1f3a-43e6-964c-6066fdbdf564",alt:"image"})}),"\n",(0,n.jsx)(t.p,{children:'Sometimes you also need to press CTRL+SHIFT+P and then type "Codespaces: View Creation Log":'}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:"https://github.com/user-attachments/assets/38b59d91-ce63-4e3c-9f0d-68b48d039ea8",alt:"image"})}),"\n",(0,n.jsx)(t.p,{children:'Then you should see log messages in the "Terminal-View":'}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:"https://github.com/user-attachments/assets/5552ef73-bce6-4129-a0b0-9d410ce47af5",alt:"image"})}),"\n",(0,n.jsx)(t.h2,{id:"accessing-platform-service-consoles",children:"accessing platform service consoles"}),"\n",(0,n.jsx)(t.p,{children:'In the "Ports-View" you will see different URLs for different platform services. When clicking on the "world" symbol you can open the URL in your browser and use the tools.'}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:"https://github.com/user-attachments/assets/bad60f85-fb88-46cf-8d73-1090a9d61647",alt:"image"})}),"\n",(0,n.jsx)(t.p,{children:"Needed credentials for the different tools are displayed in the end of the startup like this:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"kubrix delivery is set up sucessfully.\n\nArgoCD user: admin\nArgoCD password: 0g3v2Tx2maPs7oKr\n\nKargo password: admin\n"})}),"\n",(0,n.jsx)(t.h2,{id:"known-issues",children:"known issues"}),"\n",(0,n.jsx)(t.p,{children:'currently the k3d cluster "cnp-local-demo" still exists when opening the devcontainer. I am not really sure about the livecycle of the devcontainer. Currently I do the following to get rid of the problem.'}),"\n",(0,n.jsx)(t.p,{children:"stop vscode"}),"\n",(0,n.jsx)(t.p,{children:"start vscode (but don't switch to devcontainer remote explorer)"}),"\n",(0,n.jsx)(t.p,{children:"dann in vscode command (CTRL+SHIFT+P)"}),"\n",(0,n.jsx)(t.p,{children:'"dev containers: clean up dev containers"\n"dev cotainers: clean up dev volume"\n"rebuild without cache and reopen in container"'}),"\n",(0,n.jsx)(t.h1,{id:"create-cnp-local-demo-environment",children:"create cnp local demo environment"}),"\n",(0,n.jsx)(t.h2,{id:"how-to-set-it-up",children:"how to set it up"}),"\n",(0,n.jsx)(t.h3,{id:"prereqs",children:"prereqs"}),"\n",(0,n.jsx)(t.p,{children:"k3d installed\nkubectl installed"}),"\n",(0,n.jsx)(t.h4,{id:"mkcert",children:"mkcert"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"curl -L -O https://github.com/FiloSottile/mkcert/releases/download/v1.4.4/mkcert-v1.4.4-linux-amd64\nmv mkcert-v1.4.4-linux-amd64 ~/bin/mkcert\nchmod u+x ~/bin/mkcert\n"})}),"\n",(0,n.jsxs)(t.p,{children:["install the CA of mkcert in your OS truststore: ",(0,n.jsx)(t.a,{href:"https://docs.kubefirst.io/k3d/quick-start/install#install-the-ca-certificate-authority-of-mkcert-in-your-trusted-store",children:"https://docs.kubefirst.io/k3d/quick-start/install#install-the-ca-certificate-authority-of-mkcert-in-your-trusted-store"})]}),"\n",(0,n.jsx)(t.h4,{id:"create-github-oauth-app",children:"create GitHub OAuth App"}),"\n",(0,n.jsxs)(t.p,{children:["in your Github Organization for Backstage login: ",(0,n.jsx)(t.a,{href:"https://backstage.io/docs/auth/github/provider/",children:"https://backstage.io/docs/auth/github/provider/"})]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["Homepage URL: ",(0,n.jsx)(t.a,{href:"https://backstage-127-0-0-1.nip.io",children:"https://backstage-127-0-0-1.nip.io"})]}),"\n",(0,n.jsxs)(t.li,{children:["Authorization callback URL: ",(0,n.jsx)(t.a,{href:"https://backstage-127-0-0-1.nip.io/api/auth/github",children:"https://backstage-127-0-0-1.nip.io/api/auth/github"})]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"use GITHUB_CLIENTSECRET and GITHUB_CLIENTID from your Github OAuth App for the following environment variables in step 1"}),"\n",(0,n.jsx)(t.h3,{id:"1-define-some-variables-so-the-platform-can-access-github",children:"1. define some variables so the platform can access github"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"export GITHUB_CLIENTSECRET=<value from steps above>\nexport GITHUB_CLIENTID=<value from steps above>\nexport GITHUB_TOKEN=<your personal access token>\nexport GITHUB_APPSET_TOKEN=<github-pat-for-argocd-appsets-only-read-permissions-needed>\n"})}),"\n",(0,n.jsx)(t.h3,{id:"2-create-k3d-cluster",children:"2. create k3d cluster"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"export TARGET_TYPE=K3D\n# if you use a KIND cluster you should set:\n# export TARGET_TYPE=KIND\n# if you want to test another branch, specify something else than main\nexport CURRENT_BRANCH=main\ncurl -L https://raw.githubusercontent.com/suxess-it/sx-cnp-oss/${CURRENT_BRANCH}/install-platform.sh | bash\n"})}),"\n",(0,n.jsx)(t.p,{children:'With this command a new k3d cluster gets created.\nA "bootstrap argocd" get\'s installed via helm.\nA "boostrap-app" gets installed which references all other apps in the plattform-stack (app-of-apps pattern)\nArgoCD itself is also then managed by an argocd app.'}),"\n",(0,n.jsx)(t.p,{children:"The platform stack will be installed automagically ;)"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"backstage"}),"\n",(0,n.jsx)(t.li,{children:"argocd (managed by argocd)"}),"\n",(0,n.jsx)(t.li,{children:"argo-rollouts"}),"\n",(0,n.jsx)(t.li,{children:"kargo"}),"\n",(0,n.jsx)(t.li,{children:"cert-manager"}),"\n",(0,n.jsx)(t.li,{children:"crossplane"}),"\n",(0,n.jsx)(t.li,{children:"kyverno"}),"\n",(0,n.jsx)(t.li,{children:"prometheus"}),"\n",(0,n.jsx)(t.li,{children:"grafana"}),"\n",(0,n.jsx)(t.li,{children:"promtail"}),"\n",(0,n.jsx)(t.li,{children:"loki"}),"\n",(0,n.jsx)(t.li,{children:"tempo"}),"\n",(0,n.jsx)(t.li,{children:"kubecost"}),"\n",(0,n.jsx)(t.li,{children:"keycloak"}),"\n",(0,n.jsx)(t.li,{children:"external-secret-operator"}),"\n",(0,n.jsx)(t.li,{children:"falco"}),"\n"]}),"\n",(0,n.jsx)(t.h3,{id:"3-log-in-to-the-tools",children:"3. log in to the tools"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Tool"}),(0,n.jsx)(t.th,{children:"URL"}),(0,n.jsx)(t.th,{children:"Username"}),(0,n.jsx)(t.th,{children:"Password"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Backstage"}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.a,{href:"https://backstage-127-0-0-1.nip.io",children:"https://backstage-127-0-0-1.nip.io"})}),(0,n.jsx)(t.td,{children:"via github"}),(0,n.jsx)(t.td,{children:"via github"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"ArgoCD"}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.a,{href:"https://argocd-127-0-0-1.nip.io/",children:"https://argocd-127-0-0-1.nip.io/"})}),(0,n.jsx)(t.td,{children:"admin"}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"kubectl get secret -n argocd argocd-initial-admin-secret -o=jsonpath='{.data.password}' | base64 -d"})})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Kargo"}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.a,{href:"https://kargo-127-0-0-1.nip.io",children:"https://kargo-127-0-0-1.nip.io"})}),(0,n.jsx)(t.td,{children:"admin"}),(0,n.jsx)(t.td,{children:"-"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Grafana"}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.a,{href:"https://grafana-127-0-0-1.nip.io",children:"https://grafana-127-0-0-1.nip.io"})}),(0,n.jsx)(t.td,{children:"admin"}),(0,n.jsx)(t.td,{children:"prom-operator"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Keycloak"}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.a,{href:"https://keycloak-127-0-0-1.nip.io",children:"https://keycloak-127-0-0-1.nip.io"})}),(0,n.jsx)(t.td,{children:"admin"}),(0,n.jsx)(t.td,{children:"admin"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"FalcoUI"}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.a,{href:"https://falco-127-0-0-1.nip.io",children:"https://falco-127-0-0-1.nip.io"})}),(0,n.jsx)(t.td,{children:"admin"}),(0,n.jsx)(t.td,{children:"admin"})]})]})]}),"\n",(0,n.jsx)(t.h3,{id:"4-kubecost",children:"4. kubecost"}),"\n",(0,n.jsxs)(t.p,{children:["initialization need some minutes until values are visible in UI - ",(0,n.jsx)(t.a,{href:"https://kubecost-127-0-0-1.nip.io/overview",children:"https://kubecost-127-0-0-1.nip.io/overview"})]}),"\n",(0,n.jsx)(t.h3,{id:"5-keycloak",children:"5. keycloak"}),"\n",(0,n.jsx)(t.p,{children:"depending on Hardare initialization need some minutes until keycloak is running"}),"\n",(0,n.jsx)(t.h3,{id:"6-onboard-teams-and-applications",children:"6. Onboard teams and applications"}),"\n",(0,n.jsxs)(t.p,{children:["In our ",(0,n.jsx)(t.a,{href:"https://github.com/suxess-it/sx-cnp-oss/blob/main/backstage-resources/docs/ONBOARDING.md",children:"Onboarding-Documentation"})," we explain how new teams and apps get onboarded on the platform in a gitops way."]}),"\n",(0,n.jsx)(t.h3,{id:"7-promote-apps-with-kargo",children:"7. Promote apps with Kargo"}),"\n",(0,n.jsx)(t.p,{children:"tbd"}),"\n",(0,n.jsx)(t.h3,{id:"delete-k3d-cluster",children:"delete k3d cluster"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"k3d cluster stop cnp-local-demo\nk3d cluster delete cnp-local-demo\n"})}),"\n",(0,n.jsx)(t.h3,{id:"build-suxess-backstage-container-image-and-push-it-to-our-registry",children:"Build suXess backstage container image and push it to our registry"}),"\n",(0,n.jsx)(t.h4,{id:"automatically-with-github-actions",children:"automatically with Github Actions"}),"\n",(0,n.jsxs)(t.p,{children:["Workflow-File: ",(0,n.jsx)(t.a,{href:"https://github.com/suxess-it/sx-backstage/blob/feat/cnp-local-demo-jokl/.github/workflows/ci.yaml",children:"https://github.com/suxess-it/sx-backstage/blob/feat/cnp-local-demo-jokl/.github/workflows/ci.yaml"})]}),"\n",(0,n.jsx)(t.h4,{id:"manually-on-local-machine",children:"manually on local machine"}),"\n",(0,n.jsx)(t.p,{children:"dual arch build, x86 and arm64, arm64 build could take up to 50 minutes"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"git clone https://github.com/suxess-it/sx-backstage.git\ncd sx-backstage\ngit switch feat/cnp-local-demo-jokl\n# modify code, test, commit\ndocker build -t sx-backstage:latest .\ndocker tag sx-backstage:latest ghcr.io/suxess-it/sx-backstage:latest\ndocker push ghcr.io/suxess-it/sx-backstage:latest\nkubectl rollout restart deploy/sx-backstage -n backstage\n"})})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},8453:(e,t,s)=>{s.d(t,{R:()=>r,x:()=>l});var n=s(6540);const i={},a=n.createContext(i);function r(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),n.createElement(a.Provider,{value:t},e.children)}}}]);